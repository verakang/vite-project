import{_ as m,o as l,c as o,a as t,F as _,f as g,h as p,t as d,i as v,n as x,g as y,v as b,d as f}from"./index-cde5024b.js";const{VITE_APP_URL:u,VITE_APP_PATH:h}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"vera-select",BASE_URL:"/vite-project/",MODE:"production",DEV:!1,PROD:!0},C={data(){return{products:[],product:{},productId:"",cart:{},loadingItem:""}},methods:{getCarts(){this.$http.get(`${u}v2/api/${h}/cart`).then(e=>{this.cart=e.data.data}).catch(e=>{alert(`${e.data.message}，請再次確認。`)})},updateCart(e){const c={product_id:e.product_id,qty:e.qty};this.loadingItem=e.id,this.$http.put(`${u}v2/api/${h}/cart/${e.id}`,{data:c}).then(r=>{alert(r.data.message),this.getCarts(),this.loadingItem=""}).catch(r=>{alert(`${r.data.message}，請再次確認。`)})},removeItem(e){this.loadingItem=e.id,this.$http.delete(`${u}v2/api/${h}/cart/${e.id}`).then(()=>{this.getCarts(),this.loadingItem="",alert(`已刪除 ${e.product.title}`)}).catch(c=>{alert(`${c.data.message}，請再次確認。`)})},deleteCart(){this.$http.delete(`${u}v2/api/${h}/carts`).then(()=>{alert("已清空購物車！"),this.getCarts()}).catch(e=>{alert(e.data.message)})}},mounted(){this.getCarts()}},I=t("h2",{class:"my-4"},"購物車列表",-1),k={class:"text-end"},$={class:"table align-middle"},P=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價")])],-1),V=["onClick"],E={key:1},A={class:"d-flex flex-column flex-md-row align-items-center"},T={class:"ms-md-3"},U={key:0,class:"text-success"},w={class:"input-group input-group-sm"},D=["onUpdate:modelValue","onChange","disabled"],q=["value"],B={class:"input-group-text",id:"basic-addon2"},L={class:"text-end"},R={key:0,class:"text-success"},S=t("td",{colspan:"3",class:"text-end"},"總計",-1),z={class:"text-end"},N=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),F={class:"text-end text-success"};function H(e,c,r,M,a,i){return l(),o(_,null,[I,t("div",k,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:c[0]||(c[0]=(...s)=>i.deleteCart&&i.deleteCart(...s))},"清空購物車")]),t("table",$,[P,t("tbody",null,[a.cart.carts?(l(!0),o(_,{key:0},g(a.cart.carts,s=>(l(),o("tr",{key:s.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:n=>i.removeItem(s)},[s.id===a.loadingItem?(l(),o("i",{key:0,class:v(["fas fa-pulse",{"fa-spinner":s.id===a.loadingItem}])},null,2)):(l(),o("span",E,"X"))],8,V)]),t("td",A,[t("div",{style:x([{width:"160px",height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${s.product.imageUrl})`}])},null,4),t("div",T,[t("span",null,d(s.product.title),1),s.coupon?(l(),o("div",U," 已套用優惠券 ")):p("",!0)])]),t("td",null,[t("div",w,[y(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":n=>s.qty=n,onChange:n=>i.updateCart(s),disabled:s.id===a.loadingItem},[(l(),o(_,null,g(10,n=>t("option",{value:n,key:`${n}01`},d(n),9,q)),64))],40,D),[[b,s.qty]]),t("span",B,d(s.product.unit),1)])]),t("td",L,[a.cart.final_total!==a.cart.total?(l(),o("small",R,"折扣價：")):p("",!0),f(" "+d(s.total)+" 元 ",1)])]))),128)):p("",!0)]),t("tfoot",null,[t("tr",null,[S,t("td",z,d(a.cart.total)+" 元",1)]),t("tr",null,[N,t("td",F,d(a.cart.final_total)+" 元",1)])])])],64)}const j=m(C,[["render",H]]);export{j as default};
