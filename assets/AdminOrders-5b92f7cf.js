import{m as T,p as M}from"./modalMixin-a87ce17e.js";import{_ as $,o as r,c as n,a as e,t as s,F as u,f as y,h as x,d as p,g as w,m as P,r as b,b as g}from"./index-cde5024b.js";const C={data(){return{modal:"",orderTemp:{}}},mixins:[T],props:{order:{type:Object,default(){return{}}},updateOrder:{type:Function}},watch:{order(){this.orderTemp=this.order}}},V={ref:"modal",id:"orderModal",class:"modal fade",tabindex:"-1"},E={class:"modal-dialog modal-lg"},A={class:"modal-content border-0"},D=e("div",{class:"modal-header bg-dark text-white"},[e("h5",{id:"productModalLabel",class:"modal-title"},[e("span",null,"檢視訂單")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),L={class:"modal-body"},j={class:"row justify-content-center"},U={class:"col-sm-10"},B=e("h3",{class:"h4 mt-3"},"訂單資料",-1),F={class:"table mt-3"},H=e("th",{width:"120px"},"訂單編號",-1),I={class:"text-warning"},N=e("th",null,"訂購日期",-1),R=e("th",null,"購買品項",-1),Y={class:"text-warning mb-0"},q={class:"mb-2"},S=e("h3",{class:"h4 mt-5"},"聯絡資訊",-1),z={class:"table mt-3"},G={key:0},J=e("th",{width:"120px"},"收件人姓名",-1),K=e("th",null,"收件人電話",-1),Q=e("th",null,"收件人信箱",-1),W=e("th",null,"收件人地址",-1),X={class:"col-sm-10"},Z={class:"form-check d-flex justify-content-end align-items-baseline"},ee={class:"mb-0"},te={class:"text-danger fs-4"},se=["id"],oe=e("label",{class:"form-check-label me-3",for:"`{orderTemp.id}`"},"是否付款",-1),de={key:0,class:"badge bg-success"},re={key:1,class:"badge bg-danger"},ne={class:"modal-footer"},le=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ae(l,o,d,_,t,c){return r(),n("div",V,[e("div",E,[e("div",A,[D,e("div",L,[e("div",j,[e("div",U,[B,e("table",F,[e("tbody",null,[e("tr",null,[H,e("td",I,"[ "+s(t.orderTemp.id)+" ]",1)]),e("tr",null,[N,e("td",null,s(t.orderTemp.create_at),1)]),e("tr",null,[R,e("td",null,[(r(!0),n(u,null,y(t.orderTemp.products,(i,m)=>(r(),n("div",{class:"m-2",key:m},[e("p",Y,"[ "+s(m)+" ]",1),e("p",q,s(i.product.title)+" x "+s(i.qty)+" / 單價："+s(i.product.price)+" 元",1)]))),128))])])])]),S,e("table",z,[t.orderTemp.user?(r(),n("tbody",G,[e("tr",null,[J,e("td",null,s(t.orderTemp.user.name),1)]),e("tr",null,[K,e("td",null,s(t.orderTemp.user.tel),1)]),e("tr",null,[Q,e("td",null,s(t.orderTemp.user.email),1)]),e("tr",null,[W,e("td",null,s(t.orderTemp.user.address),1)])])):x("",!0)])]),e("div",X,[e("div",Z,[e("p",ee,[p("訂單金額："),e("span",te,s(t.orderTemp.total),1),p(" 元")]),e("div",null,[w(e("input",{id:"{orderTemp.id}",class:"form-check-input ms-4 me-2",type:"checkbox","onUpdate:modelValue":o[0]||(o[0]=i=>t.orderTemp.is_paid=i)},null,8,se),[[P,t.orderTemp.is_paid]]),oe,t.orderTemp.is_paid?(r(),n("span",de,"已付款")):(r(),n("span",re,"未付款"))])])])])]),e("div",ne,[le,e("button",{type:"button",class:"btn btn-primary",onClick:o[1]||(o[1]=i=>d.updateOrder(t.orderTemp))}," 修改 ")])])])],512)}const ie=$(C,[["render",ae]]),ce={data(){return{modal:"",orderTemp:{}}},mixins:[T],props:{order:{type:Object,default(){return{}}},removeOrder:{type:Function}},watch:{order(){this.orderTemp=this.order}}},_e={ref:"modal",id:"delOrder",class:"modal fade",tabindex:"-1"},he={class:"modal-dialog"},pe={class:"modal-content border-0"},me=e("div",{class:"modal-header bg-danger text-white"},[e("h5",{id:"delProductModalLabel",class:"modal-title"},[e("span",null,"刪除訂單")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ue={class:"modal-body"},be={class:"text-danger"},ge=e("br",null,null,-1),fe={class:"modal-footer"},ve=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ye(l,o,d,_,t,c){return r(),n("div",_e,[e("div",he,[e("div",pe,[me,e("div",ue,[p(" 是否刪除訂單： "),e("strong",be,s(t.orderTemp.id),1),ge,p("(刪除後將無法恢復)。 ")]),e("div",fe,[ve,e("button",{type:"button",class:"btn btn-danger",onClick:o[0]||(o[0]=i=>d.removeOrder(t.orderTemp))}," 確認刪除 ")])])])],512)}const $e=$(ce,[["render",ye]]),{VITE_APP_URL:f,VITE_APP_PATH:v}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"vera-select",BASE_URL:"/vite-project/",MODE:"production",DEV:!1,PROD:!0},Te={data(){return{orders:[],orderTemp:{imagesUrl:[]},page:{}}},components:{pagination:M,orderModal:ie,delOrder:$e},methods:{getOrder(l=1){const o=`${f}v2/api/${v}/admin/orders/?page=${l}`;this.$http.get(o).then(d=>{this.orders=d.data.orders,this.page=d.data.pagination}).catch(d=>{alert(d.response.data.message)})},openModal(l,o){l==="edit"?(this.$refs.orderModal.openModal(),this.orderTemp={...o}):l==="delete"&&(this.$refs.delOrder.openModal(),this.orderTemp={...o})},updateOrder(l){const o=`${f}v2/api/${v}/admin/order/${l.id}`,d={is_paid:l.is_paid};this.$http.put(o,{data:d}).then(_=>{alert(_.data.message),this.getOrder(),this.$refs.orderModal.hideModal()}).catch(_=>{alert(_.response.data.message)})},removeOrder(l){const o=`${f}v2/api/${v}/admin/order/${l.id}`;this.$http.delete(o).then(d=>{alert(d.data.message),this.getOrder(),this.$refs.delOrder.hideModal()}).catch(d=>{alert(d.response.data.message)})}},mounted(){this.getOrder()}},xe=e("h2",{class:"my-4"},"這是後台訂單頁面",-1),Oe={class:"table mt-4"},ke=e("thead",null,[e("tr",null,[e("th",{width:""},"購買時間"),e("th",{width:""},"Email"),e("th",{width:""},"購買款項"),e("th",{width:""},"應付金額"),e("th",{width:""},"是否付款"),e("th",{width:""},"編輯")])],-1),Me={key:0,class:"mb-0"},we={class:"text-warning"},Pe={class:"text-start"},Ce={class:"list-unstyled"},Ve={class:"text-warning mb-0"},Ee={class:"text-dark"},Ae={class:"mb-2"},De={class:"text-start"},Le={key:0,class:"text-success"},je={key:1},Ue={class:"btn-group"},Be=["onClick"],Fe=["onClick"];function He(l,o,d,_,t,c){const i=b("pagination"),m=b("orderModal"),O=b("delOrder");return r(),n(u,null,[xe,e("table",Oe,[ke,e("tbody",null,[(r(!0),n(u,null,y(t.orders,a=>(r(),n("tr",{key:a.id},[e("td",null,s(l.$moment(new Date(a.create_at*1e3)).format("YYYY-MM-DD HH:mm")),1),e("td",null,[a.user?(r(),n("p",Me,s(a.user.email),1)):x("",!0),e("p",we,s(a.id),1)]),e("td",Pe,[e("ul",Ce,[(r(!0),n(u,null,y(a.products,(h,k)=>(r(),n("li",{key:k},[e("p",Ve,[p(s(h.product.title)+" ",1),e("span",Ee,"x "+s(h.qty),1)]),e("p",Ae,"單價："+s(h.product.price)+" 元",1)]))),128))])]),e("td",De,s(a.total),1),e("td",null,[a.is_paid?(r(),n("span",Le,"已付款")):(r(),n("span",je,"未付款"))]),e("td",null,[e("div",Ue,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:h=>c.openModal("edit",a)}," 檢視 ",8,Be),e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:h=>c.openModal("delete",a)}," 刪除 ",8,Fe)])])]))),128))])]),g(i,{class:"container",pages:t.page,onChangePage:c.getOrder},null,8,["pages","onChangePage"]),g(m,{ref:"orderModal",order:t.orderTemp,"update-order":c.updateOrder},null,8,["order","update-order"]),g(O,{ref:"delOrder",order:t.orderTemp,"remove-order":c.removeOrder},null,8,["order","remove-order"])],64)}const Re=$(Te,[["render",He]]);export{Re as default};
